<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>Animal Wildlife Estimator using Social Media by smenon8</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1><u>A</u>nimal <u>W</u>ildlife <u>ES</u>timator using <u>S</u>ocial <u>ME</u>dia
        (A. W. E. S. O. M. E)</h1>
        <h2>Scripts for identifying and quantifying biases in sharing of animal pictures on social media and models to predict likelihood of a picture being shared on social media platform.</h2>
        <h4>
        <a id="author-sreejith-menon" class="anchor" href="#author-sreejith-menon" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><b>Author:</b> Sreejith Menon
        <br> <b>Email:</b> smenon8@uic.edu
        <br>
        <a id="project-home-page-httpcompbiocsuicedusreejith" class="anchor" href="#project-home-page-httpcompbiocsuicedusreejith" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a> <b>Home-page: </b><a href="http://compbio.cs.uic.edu/%7Esreejith/">http://compbio.cs.uic.edu/~sreejith/</a>
        </h4>

        <section id="downloads" align="center">
          <a href="https://github.com/smenon8/AnimalPhotoBias/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/smenon8/AnimalPhotoBias/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/smenon8/AnimalPhotoBias" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>

      <div class="container" align="center">
          <section id="site-map">
          <a href="#tech-used" class="btn btn-primary">View Technology Keywords</a>
          <a href="#project-overview" class="btn">View Project Progress</a>
          <a href="#script-index" class="btn btn-info">View Scripts Index</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">

      <h3>
      <a id="tech-used" class="anchor" href="#tech-used" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span>Technology Keywords</a></h3>
      <ul>
      <li>Python-3</li>
      <li>Jupyter-Notebook</li>
      <li>pandas</li>
      <li>matplotlib</li>
      <li>sklearn</li>
      <li>sklearn-metrics</li>
      <li>Amazon Mechanical Turk</li>
      <li>Bash</li>
      <li>Windows Batch</li>

      </ul>

      <h3>
      <a id="project-overview" class="anchor" href="#project-overview" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span>Project Progress</a></h3>

      <ul>
      <li>Extract features from IBEIS through a function call.</li>
      <li>Completely automated the process for selection of images and creation of Amazon Mechanical Turk jobs. </li>
      <li>Completely automated deployment, approval and download for all the mechanical turk jobs.</li>
      <li>Completely automated parsing of .results file from the mechanical turk engine and return a python object/csv/json ready for processing.</li>
      <li>API available for both single as well multiple feature extraction for an images or a list of images (can be specified as a csv).</li>
      <li>API available to join features with the results and return python data-frames/csv/json for statistical calculation.</li>
      <li>API available for generating rank list of most shared pictures.</li>
      <li>API available for generating rank list by share proportion based on ecological features like species, sex, age, view_point of the animal.</li>
      <li>API available for generating rank lists for a specific feature across all albums or individual albums (number of shares for zebra in a particular album versus number of shares for giraffes etc.)</li>
      <li>API available to append the results from Amazon Mechanical Turk API with tags from Microsoft Image Tagging API and generate a rank list of most shared tags.</li>
      <li>Added functionality to generate reports of all statistics in HTML format with bar charts wherever necessary.</li>
      <li>API available for data prepartion for applying classifiers using the Bag-of-words methodology. </li>
      <li>API available for building learning models like Logistic Regression, Support Vector Machines, Decision Trees and Random Forests and returning the predictions as well as performance metrics for the classifier. </li>
      </ul>

      <h3>
      <a id="script-index" class="anchor" href="#script-index" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span>Available Scripts Index</a></h3>
      <ol>
      <li><p><a href="#GetPropertiesAPI"> GetPropertiesAPI.py </a></p>
        <ul>
          <li><a href="#getAnnotID">getAnnotID(gid)</a></li>
          <li><a href="#getImageFeature">getImageFeature(aid,feature)</a></li>
          <li><a href="#getContributorGID">getContributorGID(cid)</a></li>
          <li><a href="#getAgeFeatureReadableFmt">getAgeFeatureReadableFmt(ageList)</a></li>
        </ul>
      </li>
      <li><p><a id="generate-mturk-file-api" href="#generate-mturk-file-api"> GenerateMTurkFileAPI.py </a></p>
        <ul>
        <li><a href="#genRandomImg">genRandomImg(begin,end,oldList)</a></li>
        <li><a href="#genImageList">genImageList(begin,stop,maxImgs=20)</a></li>
        <li><a href="#generateMTurkFile">generateMTurkFile(startGID,endGID,outFile,maxImgs=20,prodFileWrite=False)</a></li>
        </ul>
      </li>
      <li><p><a href="#CreateTurkFilesBulk"> CreateTurkFilesBulk.py </a></p>
        <ul>
          <li><a href="#createTurkFilesBulk">createTurkFilesBulk(flNm,jobMapName,noOfJobs,noOfImgsPerJob = 20)</a></li> 
        </ul>
      </li>
      <li><p><a href="#DeriveFinalResultSet"> DeriveFinalResultSet.py </a></p>
      <ul>
        <li><a href="#getPosShrProptn">getPosShrProptn(imgJobMap,resStart,resEnd)</a></li>
        <li><a href="#genTotCnts">genTotCnts(ovrCnts)</a></li>
        <li><a href="#getShrProp">getShrProp(ovrAggCnts)</a></li>
        <li><a href="#getCountingLogic">getCountingLogic(gidAidMapFl,aidFeatureMapFl,feature,withNumInds=True)</a></li>
        <li><a href="#genAlbmFtrs">genAlbmFtrs(gidAidMapFl,aidFeatureMapFl,imgJobMap,reqdFtrList)</a></li>
      </ul>
      </li>
      </ol>
    <br>
    <br>
      <h3>
      <a id="GetPropertiesAPI" class="anchor" href="#GetPropertiesAPI" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span>GetPropertiesAPI.py</a></h3>
      Description: Contains methods to extract specific information from IBEIS database through REST-ful API calls.
      <ul>
      <li><a id="getAnnotID" href="#getAnnotID">getAnnotID(gid) </a></li>
              a.  Argument: GID of a single image. <br>
              b.  Argument data-type: int/str <br>
              c.  PRE-condition: <br>
              i.  gid should be a valid image ID <br>
              d.  Returns: Corresponding Annotation IDs in the image. <br>
              e.  Return data-type: Python list object <br>
              f.  Comments: Used to extract annotation IDs for a particular image GID <br>  
      <br>
      <li><a id="getImageFeature" href="#getImageFeature">getImageFeature(aid,feature)</a></li>
              a.  Arguments: Annotation ID, Required Feature <br>
              b.  Argument data-type: int/str, str <br>
              c.  PRE-condition: <br>
              i.  aid should be a valid annotation ID <br>
              ii. feature should be from the set: {species_texts, age_months_est, exemplar_flags, sex_texts, yaw_texts, quality_texts, image_contributor_tag} <br>
              d.  Returns: Corresponding feature of the specified annotation ID <br>
              e.  Return data-type: Python list object, typically with 1 element <br>
              f.  Comments: Used to extract features for a particular annotation ID. <br>

      <br>
      <li><a id="getContributorGID" href="#getContributorGID">getContributorGID(cid)</a></li>
              a.  Arguments: Contributor ID <br>
              b.  Argument data-type: int/str <br>
              c.  PRE-condition: <br>
              i.  cid should be a valid contributor ID <br>
              d.  Returns: List of images clicked by the contributor <br>
              e.  Return data-type: Python list object <br>
              f.  Comments: Used to extract all images clicked by a particular photographer. <br>

      <br>
      <li><a id="getAgeFeatureReadableFmt" href="#getAgeFeatureReadableFmt">getAgeFeatureReadableFmt(ageList)</a></li>
              a.  Arguments: Age as extracted from IBEIS API call. <br>
              b.  Arguments data-type: Python list. <br>
              c.  PRE-condition: <br>
              i.  Age should be in one of the following formats: [[-1,-1]] or [[None,2]] or [[3, 5]] or [[6, 11]] or [[12,23]] or [[24,35]] or [[36,None]] <br>
              d.  Returns: A human readable string of the age. <br>
              e.  Comments: Age in IBEIS is stored as a list (an estimated range in months). IBEIS identifies the age of the animal up to 3 years. The animals will be classified as Infants, a year-old juveniles, two-year-old juveniles or fully grown adults. <br>

      </ul>


      <br>
      <h3>
      <a id="GenerateMTurkFileAPI" class="anchor" href="#GenerateMTurkFileAPI" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span>GenerateMTurkFileAPI.py</a></h3>
      Description: Contains methods to generate a single mechanical turk photo album. There are multiple methods in the API but the method generateMTurkFile() needs to be called to generate one image album job file.
      <br>
      <i>Hardcoded parameter: excepFL – points to the CSV file which is a enumeration of all identified human images. This is provided to avoid occurrences of human images in the mechanical turk photo album jobs.</i>      

      <ul>
      <li><a id="genRandomImg" href="#genRandomImg">genRandomImg(begin,end,oldList)</a></li>
              a.  Arguments: Start range, End Range and list in the same range <br>
              b.  Argument data-type: int, int, int <br>
              c.  PRE-condition: <br>
              i.  All elements in the oldList should be in the range [begin, end] <br>
              ii. begin, end should be valid image GIDs. <br>
              d.  Returns: A randomly selected image GID in the range [begin, end] and not in oldList. <br>
              e.  Return data-type: int <br>
              f.  Comments: This method is used when there arises a case when a particular image in the image album have to be replaced with another randomly selected image. <br>

      <br>
      <li><a id="genImageList" href="#genImageList">genImageList(begin,stop,maxImgs=20)</a></li>
              a.  Arguments: Start range, end range and number of images in photo album <br>
              b.  Argument data-type: int, int, int <br>
              c.  PRE-condition: <br>
              i.  begin and stop should be both valid image GID’s. <br>
              ii. begin < stop <br>
              iii.  stop – begin > maxImgs <br>
              d.  Returns: A python list with randomly selected image GID’s that are in the range [begin, stop] and len(list) = maxImgs <br>
              e.  Comments: This method is used to generate a list of random images that will be further used as an input to the method that generates the photo album mechanical turk job. The list has no duplicates and has exactly maxImgs number of images. <br>

      <br>
      <li><a id="generateMTurkFile" href="#generateMTurkFile">generateMTurkFile(startGID,endGID,outFile,maxImgs=20,prodFileWrite=False)</a></li>
              a.  Arguments: Start GID, end GID, name of output file, number of images in photo album, a boolean to generate a m-turk job for production environment. <br>
              b.  Argument data-type: int, int, str, int, boolean <br>
              c.  PRE-condition: <br>
              i.  startGID and endGID should be both valid image GID’s. <br>
              ii. startGID < endGID <br>
              iii.  endGID - startGID > maxImgs <br>
              d.  Returns: A python list with randomly selected image GID’s that are in the photo album. The GID’s are in the range [startGID, endGID] and len(list) = maxImgs <br>
              e.  Comments: Most important method of this script. This generates a .question file that is fed to createHIT command. If prodFileWrite parameter is set to True, then a job with the same image GID’s is generated with the word ‘prod’ appended to the outFile name. prodFileWrite is defaulted to False, so it will only generate a file for mechanical turk sandbox if this parameter is unspecified. <br>
      </ul>


      <br>
      <h3>
      <a id="CreateTurkFilesBulk" class="anchor" href="#CreateTurkFilesBulk" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span>CreateTurkFilesBulk.py</a></h3>
      Description: Contains a single method that generates mechanical turk jobs for generating photo-albums in bulk. This script contains a __main__() method that accepts command line arguments and can be directly executed through terminal. <br><br>
      To run the script, provide 4 parameters in the order fileName, jobMapName, numberOfFiles, numberOfImgs. <br>
      python CreateTurkFilesBulk.py /tmp/sample /tmp/sample.CSV 2 10 <br>
      Successfully written : /tmp/sample1 <br>
      Successfully written : /tmp/sample2 <br>

      <ul>
      <li><a id="createTurkFilesBulk" href="#createTurkFilesBulk">createTurkFilesBulk(flNm,jobMapName,noOfJobs,noOfImgsPerJob = 20)</a></li>
              a.  Arguments: File Name prefix of the job files, File name of the map file of albums and the images in those albums, number of jobs needed, number of images needed per job. <br>
              b.  Argument data-type: str, str, int, int <br>
              c.  PRE-condition:  <br>
              i.  Entire path is provided for both flNm and jobMapName. <br>
              ii. Path exists in the host system. <br>
              d.  Returns: None <br>
              e.  Comments: Selects noOfJobs number of random contributors (there might be duplicates in the selected contributor list). There is hard-coded code for removing contributors who did not click any picture. For each job, noOfImgsPerJob number of images are selected from the range of images a particular contributor has clicked. This is done to ensure that given a particular album, all the images are clicked by the same contributor. The script assumes the value of prodFileWrite in line 63 as True. It generates 1 input, 1 question file per noOfJobs and 1 map file that contains a map between albums and the images in them. <br>
      </ul>
      </section>
    </div>

    
  </body>
</html>
